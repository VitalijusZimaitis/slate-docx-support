var e=require("slate-hyperscript");function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},t.apply(this,arguments)}var n=function e(t,n){if(n(t))for(var r=t.firstChild;r;){var i=r,a=r.previousSibling;r=r.nextSibling,e(i,n),i.previousSibling||i.nextSibling||i.parentNode||!r||a===r.previousSibling||!r.parentNode?i.previousSibling||i.nextSibling||i.parentNode||!r||r.previousSibling||r.nextSibling||r.parentNode||(a?r=a.nextSibling?a.nextSibling.nextSibling:null:t.firstChild&&(r=t.firstChild.nextSibling)):r=a?a.nextSibling:t.firstChild}},r="\n",i=" ",a=[function(e){return function(e){var t=e.indexOf("<html");return-1===t?e:e.slice(Math.max(0,t))}(function(e){var t=e.lastIndexOf("</html>");return-1===t?e:e.slice(0,Math.max(0,t+7))}(e))},function(e){return e.replaceAll(/(\r\n|\r)/g,"\n")}],l=function n(r,i){var a;if(void 0===i&&(i={}),r.nodeType===Node.TEXT_NODE)return e.jsx("text",i,r.textContent);if(r.nodeType!==Node.ELEMENT_NODE)return null;if(r.attributes&&r.attributes.getNamedItem("class")&&null!=(a=r.attributes.getNamedItem("class"))&&a.value.match(/done/g))return null;var l=t({},i);switch(r.nodeName){case"B":l.bold=!0;break;case"I":l.italic=!0;break;case"U":l.underline=!0;break;case"STRIKE":l.strikethrough=!0}var s,u,o=Array.from(r.childNodes).map(function(e){return n(e,l)}).flat();if(0===o.length&&o.push(e.jsx("text",l,"")),(u=(s=r).getAttribute("style"))&&/mso-list:\s*l/i.test(u)&&(Boolean(s.querySelector('[style="mso-list:Ignore"]'))||s.outerHTML.includes("\x3c!--[if !supportLists]--\x3e"))){var c=function(e){for(var t=function(e){for(var t=[];e&&e.attributes.getNamedItem("class")&&null!=(n=e.attributes.getNamedItem("class"))&&n.value.match(/MsoListParagraph/g);){var n,r,i=null==(r=e.attributes)||null==(r=r.getNamedItem("style"))||null==(r=r.value.match(/level(\d+)/))?void 0:r[1];e.setAttribute("class","done"),e.setAttribute("style",null!=i?i:"1"),t.push(e),e&&(e=e.nextElementSibling)}return t}(e),n=function(e){return/^\d+$/.test(e.textContent[0])?"OL":"UL"}(e),r=document.createElement(n),i=0;i<t.length;i++){var a=document.createElement("li"),l=t[i].innerText.replace(/[^a-zA-Z ]/g,"");t[i].classList.add("done"),a.append(l),r.appendChild(a)}return{list:r,siblings:t}}(r),d=c.list,g=c.siblings;return g.length>0&&g.forEach(function(e){e.remove()}),n(d,l)}return function(t,n){switch(t.nodeName){case"BODY":case"SPAN":case"o:p":return e.jsx("fragment",{},n);case"BR":return"\n";case"BLOCKQUOTE":return e.jsx("element",{type:"quote"},n);case"P":return e.jsx("element",{type:"paragraph"},n);case"UL":return e.jsx("element",{type:"bulleted-list"},n);case"OL":return e.jsx("element",{type:"numbered-list"},n);case"LI":return e.jsx("element",{type:"list-item"},n);case"A":return e.jsx("element",{type:"link",url:t.getAttribute("href")},n);default:return n}}(r,o)};exports.deserialize=l,exports.withDocxDeserializer=function(e){var t=e.insertData,s=e.isInline,u=e.isVoid,o=e.insertFragment;return e.insertFragment=function(e){o(e)},e.isInline=function(e){return"link"===e.type||s(e)},e.isVoid=function(e){return"image"===e.type||u(e)},e.insertData=function(s){var u,o=s.getData("text/html");if(o){var c=(new DOMParser).parseFromString(function(e){return a.reduce(function(e,t){return t(e)},e)}(o),"text/html"),d=c.body;u=function(e){if(/^\n\s*$/.test(e.data)&&(e.previousElementSibling||e.nextElementSibling))return e.remove(),!0;if(e.data=e.data.replaceAll(/\n\s*/g,"\n"),e.data.includes("\r")||e.data.includes(r)||e.data.includes(" ")){var t=e.data.includes(i),n=/\S/.test(e.data),a=e.data.includes(r);if(!t&&!n&&!a)return" "===e.data?(e.data=i,!0):(e.remove(),!0);if(e.previousSibling&&"BR"===e.previousSibling.nodeName&&e.parentElement){e.previousSibling.remove();var l=e.data.match(/^[\n\r]+/);e.data=e.data.slice(Math.max(0,l?l[0].length:0)).replaceAll(new RegExp(r,"g"),i).replaceAll(new RegExp("\r","g"),i),e.data="\n"+e.data}else e.data=e.data.replaceAll(new RegExp(r,"g"),i).replaceAll(new RegExp("\r","g"),i)}return!0},n(d,function(e){return!function(e){return e.nodeType===Node.TEXT_NODE}(e)||u(e)}),n(d,function(e){return!function(e){return e.nodeType===Node.ELEMENT_NODE}(e)||((n=(t=e).getAttribute("style"))&&t.setAttribute("style",n.replaceAll(/mso-list:\s*ignore/gi,"mso-list:Ignore")),!0);var t,n});var g=l(c.body);return e.insertFragment(g)}t(s)},e};
//# sourceMappingURL=index.cjs.map
