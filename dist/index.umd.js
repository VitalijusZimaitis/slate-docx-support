!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("blob-util")):"function"==typeof define&&define.amd?define(["exports","blob-util"],t):t((e||self).slateDocxSupport={},e.blobUtil)}(this,function(e,t){function n(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,t}var r=/*#__PURE__*/n(t),i=function(e){var t,n=[],r=e.length/2;for(t=0;t<r;t++)n.push(parseInt(e.substr(2*t,2),16));return n},u=function(e){var t,n="",r=e.length;for(t=0;t<r;t+=3){var i=e.slice(t,t+3),u=i.length,a=[];if(u<3)for(var o=u;o<3;o++)i[o]=0;a[0]=(252&i[0])>>2,a[1]=(3&i[0])<<4|i[1]>>4,a[2]=(15&i[1])<<2|(192&i[2])>>6,a[3]=63&i[2];for(var l=0;l<4;l++)n+=l<=u?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a[l]):"="}return n},a={A:function(e){return{type:"link",url:e.getAttribute("href")}},BLOCKQUOTE:function(){return{type:"quote"}},H1:function(){return{type:"heading-one"}},H2:function(){return{type:"heading-two"}},H3:function(){return{type:"heading-three"}},H4:function(){return{type:"heading-four"}},H5:function(){return{type:"heading-five"}},H6:function(){return{type:"heading-six"}},IMG:function(e){return{type:"image",url:e.getAttribute("src")}},LI:function(e){return{type:"list-item"}},OL:function(){return{type:"numbered-list"}},P:function(){return{type:"paragraph"}},PRE:function(){return{type:"code"}},UL:function(){return{type:"bulleted-list"}},TABLE:function(){return{type:"table"}},TR:function(){return{type:"table-row"}},TD:function(){return{type:"table-cell"}}},o={CODE:function(){return{code:!0}},DEL:function(){return{strikethrough:!0}},EM:function(){return{italic:!0}},I:function(){return{italic:!0}},S:function(){return{strikethrough:!0}},B:function(){return{bold:!0}},U:function(){return{underline:!0}}};e.withDocxDeserializer=function(e,t){var n=e.insertData,l=e.isInline,f=e.isVoid,c=e.insertFragment,s=function(e){var t=function(t,r){return t.attributes&&t.attributes.getNamedItem("class")&&t.attributes.getNamedItem("class").value.match(/done/g)?null:function(e){return!!(e.attributes&&e.attributes.getNamedItem("class")&&e.attributes.getNamedItem("class").value.match(/MsoListParagraph/g))}(t)?function(t,r){var i=function(e){for(var t=[];e&&e.attributes.getNamedItem("class")&&e.attributes.getNamedItem("class").value.match(/MsoListParagraph/g);){var n=e.attributes.getNamedItem("style").value.match(/level(\d+)/)[1];e.setAttribute("class","done"),e.setAttribute("style",n),t.push(e),e=e.nextElementSibling}return t}(t);console.log(t);for(var u=document.createElement("UL"),l=0;l<i.length;l++)u.appendChild(i[l]);var f=a.UL(u),c=Array.from(u.childNodes).map(function(t){return function(t,r){var i=t.getAttribute("style"),u=function(e){var t=Array.from(e.childNodes),n=[];return t.map(function(e){o[e.nodeName]||"#text"===e.nodeName?n.push(e):"SPAN"===e.nodeName&&(e.textContent=e.textContent.replace(/(^(\W)(?=\s)*)|(o\s)(?!\w)/gm,""),n.push(e))}),n}(t).map(function(e){return n(e,r)}).flat();return e("element",{type:"list-item",className:"level".concat(i)},u)}(t,r)}).flat();return e("element",f,c)}(t,r):n(t,r)};function n(n,r){if(3===n.nodeType)return"O:P"===n.parentNode.nodeName&&"P"===n.parentNode.parentNode.nodeName?n.textContent:n.textContent.match(/^[\s]*$/gm)?null:(n.textContent=n.textContent.replace(/\n(?!\n)/g," "),n.textContent);if(1!==n.nodeType)return null;if("BR"===n.nodeName)return"\n";var i=n.nodeName,u=n;"PRE"===i&&n.childNodes[0]&&"CODE"===n.childNodes[0].nodeName&&(u=n.childNodes[0]);var l=Array.from(u.childNodes).map(function(e){return t(e,r)}).flat();if("BODY"===n.nodeName){var f=e("element",{type:"p",className:"P"},[{text:" "}]);return l.unshift(f),e("fragment",{},l)}if(a[i]){if("IMG"===i){var c=n.getAttribute("src");r[c]&&(n.setAttribute("src",r[c]),l=[]);var s=a[i](n);return e("element",s,l)}if("H3"===i||"H2"===i||"H1"===i)return e("element",{type:i,className:i},l);var d=a[i](n);return e("element",d,l)}if(o[i]){var p=o[i](n);return l.map(function(t){return e("text",p,t)})}return l}return t}(t);return e.insertFragment=function(e){c(e)},e.isInline=function(e){return"link"===e.type||l(e)},e.isVoid=function(e){return"image"===e.type||f(e)},e.insertData=function(t){var a=t.getData("text/html"),o=function(e,t){var n={},a=function(e){for(var t,n=/<img[^>]+src="([^"]+)[^>]+/g,r=[];t=n.exec(e);)r.push(t[1]);return r}(t),o=[],l=function(e){var t=[],n=/\{\\pict[\s\S]+?\\bliptag\-?\d+(\\blipupi\-?\d+)?(\{\\\*\\blipuid\s?[\da-fA-F]+)?[\s\}]*?/,r=new RegExp("(?:("+n.source+"))([\\da-fA-F\\s]+)\\}","g"),i="",u=e.match(r);if(!u)return t;for(var a=0;a<u.length;a++)if(n.test(u[a])){if(-1!==u[a].indexOf("\\pngblip"))i="image/png";else{if(-1===u[a].indexOf("\\jpegblip"))continue;i="image/jpeg"}t.push({hex:i?u[a].replace(n,"").replace(/[^\da-fA-F]/g,""):null,type:i})}return t}(e);if(0!==l.length){for(var f=0;f<l.length;f++){var c=u(i(l[f].hex)),s=r.base64StringToBlob(c),d=(window.URL||window.webkitURL).createObjectURL(s);o.push(d)}if(a.length===o.length)for(var p=0;p<a.length;p++)0===a[p].indexOf("file://")&&o[p]&&(n[a[p]]=o[p]);return n}}(t.getData("text/rtf"),a);if(a){var l=(new DOMParser).parseFromString(a,"text/html"),f=s(l.body,o);e.insertFragment(f)}else n(t)},e}});
//# sourceMappingURL=index.umd.js.map
