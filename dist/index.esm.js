import*as t from"blob-util";var e=function(t){var e,n=[],r=t.length/2;for(e=0;e<r;e++)n.push(parseInt(t.substr(2*e,2),16));return n},n=function(t){var e,n="",r=t.length;for(e=0;e<r;e+=3){var a=t.slice(e,e+3),i=a.length,u=[];if(i<3)for(var o=i;o<3;o++)a[o]=0;u[0]=(252&a[0])>>2,u[1]=(3&a[0])<<4|a[1]>>4,u[2]=(15&a[1])<<2|(192&a[2])>>6,u[3]=63&a[2];for(var s=0;s<4;s++)n+=s<=i?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(u[s]):"="}return n},r={A:function(t){return{type:"link",url:t.getAttribute("href")}},LI:function(t){return{type:"list-item"}},OL:function(){return{type:"numbered-list"}},P:function(){return{type:"paragraph"}},UL:function(){return{type:"bulleted-list"}}},a={DEL:function(){return{strikethrough:!0}},EM:function(){return{italic:!0}},I:function(){return{italic:!0}},S:function(){return{strikethrough:!0}},B:function(){return{bold:!0}},U:function(){return{underline:!0}}},i=function(i,u){var o=i.insertData,s=i.isInline,l=i.isVoid,c=i.insertFragment,f=function(t){var e=function(e,i){return e.attributes&&e.attributes.getNamedItem("class")&&e.attributes.getNamedItem("class").value.match(/done/g)?null:function(t){return!!(t.attributes&&t.attributes.getNamedItem("class")&&t.attributes.getNamedItem("class").value.match(/MsoListParagraph/g))}(e)?function(e,i){for(var u=function(t){for(var e=[];t&&t.attributes.getNamedItem("class")&&t.attributes.getNamedItem("class").value.match(/MsoListParagraph/g);){var n=t.attributes.getNamedItem("style").value.match(/level(\d+)/)[1];t.setAttribute("class","done"),t.setAttribute("style",n),e.push(t),t=t.nextElementSibling}return e}(e),o=function(t){return/^\d+$/.test(t.textContent[0])?"OL":"UL"}(e),s=document.createElement(o),l=0;l<u.length;l++)s.appendChild(u[l]);var c=r[o](s),f=Array.from(s.childNodes).map(function(e){return function(e,r){var i=e.getAttribute("style"),u=function(t){var e=Array.from(t.childNodes),n=[];return e.map(function(t){a[t.nodeName]||"#text"===t.nodeName?n.push(t):"SPAN"===t.nodeName&&(t.textContent=t.textContent.replace(/(^(\W)(?=\s)*)|(o\s)(?!\w)|[0-9]\)/gm,""),n.push(t))}),n}(e).map(function(t){return n(t,r)}).flat();return t("element",{type:"list-item",className:"level".concat(i)},u)}(e,i)}).flat();return t("element",c,f)}(e,i):n(e,i)};function n(n,i){if(3===n.nodeType)return"O:P"===n.parentNode.nodeName&&"P"===n.parentNode.parentNode.nodeName?n.textContent:n.textContent.match(/^[\s]*$/gm)?null:(n.textContent=n.textContent.replace(/\n(?!\n)/g," "),n.textContent);if(1!==n.nodeType)return null;if("BR"===n.nodeName)return"\n";var u=n.nodeName,o=n;"PRE"===u&&n.childNodes[0]&&"CODE"===n.childNodes[0].nodeName&&(o=n.childNodes[0]);var s=Array.from(o.childNodes).map(function(t){return e(t,i)}).flat();if("BODY"===n.nodeName){var l=t("element",{type:"p",className:"P"},[{text:" "}]);return s.unshift(l),t("fragment",{},s)}if(r[u]){if("IMG"===u){var c=n.getAttribute("src");i[c]&&(n.setAttribute("src",i[c]),s=[]);var f=r[u](n);return t("element",f,s)}if(n.attributes&&n.attributes.getNamedItem("class")&&n.attributes.getNamedItem("class").value.match(/msocomanchor|MsoCommentText/g))return null;if("H3"===u||"H2"===u||"H1"===u)return t("element",{type:u,className:u},s);var m=r[u](n);return t("element",m,s)}if(a[u]){var d=a[u](n);return s.map(function(e){return t("text",d,e)})}return s}return e}(u);return i.insertFragment=function(t){c(t)},i.isInline=function(t){return"link"===t.type||s(t)},i.isVoid=function(t){return"image"===t.type||l(t)},i.insertData=function(r){var a=r.getData("text/html"),u=function(r,a){var i={},u=function(t){for(var e,n=/<img[^>]+src="([^"]+)[^>]+/g,r=[];e=n.exec(t);)r.push(e[1]);return r}(a),o=[],s=function(t){var e=[],n=/\{\\pict[\s\S]+?\\bliptag\-?\d+(\\blipupi\-?\d+)?(\{\\\*\\blipuid\s?[\da-fA-F]+)?[\s\}]*?/,r=new RegExp("(?:("+n.source+"))([\\da-fA-F\\s]+)\\}","g"),a="",i=t.match(r);if(!i)return e;for(var u=0;u<i.length;u++)if(n.test(i[u])){if(-1!==i[u].indexOf("\\pngblip"))a="image/png";else{if(-1===i[u].indexOf("\\jpegblip"))continue;a="image/jpeg"}e.push({hex:a?i[u].replace(n,"").replace(/[^\da-fA-F]/g,""):null,type:a})}return e}(r);if(0!==s.length){for(var l=0;l<s.length;l++){var c=n(e(s[l].hex)),f=t.base64StringToBlob(c),m=(window.URL||window.webkitURL).createObjectURL(f);o.push(m)}if(u.length===o.length)for(var d=0;d<u.length;d++)0===u[d].indexOf("file://")&&o[d]&&(i[u[d]]=o[d]);return i}}(r.getData("text/rtf"),a);if(a){var s=(new DOMParser).parseFromString(a,"text/html"),l=f(s.body,u);i.insertFragment(l)}else o(r)},i};export{i as withDocxDeserializer};
//# sourceMappingURL=index.esm.js.map
