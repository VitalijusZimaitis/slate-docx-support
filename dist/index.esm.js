import*as t from"blob-util";var e=function(t){var e,n=[],r=t.length/2;for(e=0;e<r;e++)n.push(parseInt(t.substr(2*e,2),16));return n},n=function(t){var e,n="",r=t.length;for(e=0;e<r;e+=3){var i=t.slice(e,e+3),u=i.length,a=[];if(u<3)for(var o=u;o<3;o++)i[o]=0;a[0]=(252&i[0])>>2,a[1]=(3&i[0])<<4|i[1]>>4,a[2]=(15&i[1])<<2|(192&i[2])>>6,a[3]=63&i[2];for(var l=0;l<4;l++)n+=l<=u?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a[l]):"="}return n},r={A:function(t){return{type:"link",url:t.getAttribute("href")}},BLOCKQUOTE:function(){return{type:"quote"}},H1:function(){return{type:"heading-one"}},H2:function(){return{type:"heading-two"}},H3:function(){return{type:"heading-three"}},H4:function(){return{type:"heading-four"}},H5:function(){return{type:"heading-five"}},H6:function(){return{type:"heading-six"}},IMG:function(t){return{type:"image",url:t.getAttribute("src")}},LI:function(t){return{type:"list-item"}},OL:function(){return{type:"numbered-list"}},P:function(){return{type:"paragraph"}},PRE:function(){return{type:"code"}},UL:function(){return{type:"bulleted-list"}},TABLE:function(){return{type:"table"}},TR:function(){return{type:"table-row"}},TD:function(){return{type:"table-cell"}}},i={CODE:function(){return{code:!0}},DEL:function(){return{strikethrough:!0}},EM:function(){return{italic:!0}},I:function(){return{italic:!0}},S:function(){return{strikethrough:!0}},B:function(){return{bold:!0}},U:function(){return{underline:!0}}},u=function(u,a){var o=u.insertData,l=u.isInline,c=u.isVoid,f=u.insertFragment,s=function(t){var e=function(e,u){return e.attributes&&e.attributes.getNamedItem("class")&&e.attributes.getNamedItem("class").value.match(/done/g)?null:function(t){return!!(t.attributes&&t.attributes.getNamedItem("class")&&t.attributes.getNamedItem("class").value.match(/MsoListParagraph/g))}(e)?function(e,u){var a=function(t){for(var e=[];t&&t.attributes.getNamedItem("class")&&t.attributes.getNamedItem("class").value.match(/MsoListParagraph/g);){var n=t.attributes.getNamedItem("style").value.match(/level(\d+)/)[1];t.setAttribute("class","done"),t.setAttribute("style",n),e.push(t),t=t.nextElementSibling}return e}(e);console.log(e);for(var o=document.createElement("UL"),l=0;l<a.length;l++)o.appendChild(a[l]);var c=r.UL(o),f=Array.from(o.childNodes).map(function(e){return function(e,r){var u=e.getAttribute("style"),a=function(t){var e=Array.from(t.childNodes),n=[];return e.map(function(t){i[t.nodeName]||"#text"===t.nodeName?n.push(t):"SPAN"===t.nodeName&&(t.textContent=t.textContent.replace(/(^(\W)(?=\s)*)|(o\s)(?!\w)/gm,""),n.push(t))}),n}(e).map(function(t){return n(t,r)}).flat();return t("element",{type:"list-item",className:"level".concat(u)},a)}(e,u)}).flat();return t("element",c,f)}(e,u):n(e,u)};function n(n,u){if(3===n.nodeType)return"O:P"===n.parentNode.nodeName&&"P"===n.parentNode.parentNode.nodeName?n.textContent:n.textContent.match(/^[\s]*$/gm)?null:(n.textContent=n.textContent.replace(/\n(?!\n)/g," "),n.textContent);if(1!==n.nodeType)return null;if("BR"===n.nodeName)return"\n";var a=n.nodeName,o=n;"PRE"===a&&n.childNodes[0]&&"CODE"===n.childNodes[0].nodeName&&(o=n.childNodes[0]);var l=Array.from(o.childNodes).map(function(t){return e(t,u)}).flat();if("BODY"===n.nodeName){var c=t("element",{type:"p",className:"P"},[{text:" "}]);return l.unshift(c),t("fragment",{},l)}if(r[a]){if("IMG"===a){var f=n.getAttribute("src");u[f]&&(n.setAttribute("src",u[f]),l=[]);var s=r[a](n);return t("element",s,l)}if("H3"===a||"H2"===a||"H1"===a)return t("element",{type:a,className:a},l);var m=r[a](n);return t("element",m,l)}if(i[a]){var p=i[a](n);return l.map(function(e){return t("text",p,e)})}return l}return e}(a);return u.insertFragment=function(t){f(t)},u.isInline=function(t){return"link"===t.type||l(t)},u.isVoid=function(t){return"image"===t.type||c(t)},u.insertData=function(r){var i=r.getData("text/html"),a=function(r,i){var u={},a=function(t){for(var e,n=/<img[^>]+src="([^"]+)[^>]+/g,r=[];e=n.exec(t);)r.push(e[1]);return r}(i),o=[],l=function(t){var e=[],n=/\{\\pict[\s\S]+?\\bliptag\-?\d+(\\blipupi\-?\d+)?(\{\\\*\\blipuid\s?[\da-fA-F]+)?[\s\}]*?/,r=new RegExp("(?:("+n.source+"))([\\da-fA-F\\s]+)\\}","g"),i="",u=t.match(r);if(!u)return e;for(var a=0;a<u.length;a++)if(n.test(u[a])){if(-1!==u[a].indexOf("\\pngblip"))i="image/png";else{if(-1===u[a].indexOf("\\jpegblip"))continue;i="image/jpeg"}e.push({hex:i?u[a].replace(n,"").replace(/[^\da-fA-F]/g,""):null,type:i})}return e}(r);if(0!==l.length){for(var c=0;c<l.length;c++){var f=n(e(l[c].hex)),s=t.base64StringToBlob(f),m=(window.URL||window.webkitURL).createObjectURL(s);o.push(m)}if(a.length===o.length)for(var p=0;p<a.length;p++)0===a[p].indexOf("file://")&&o[p]&&(u[a[p]]=o[p]);return u}}(r.getData("text/rtf"),i);if(i){var l=(new DOMParser).parseFromString(i,"text/html"),c=s(l.body,a);u.insertFragment(c)}else o(r)},u};export{u as withDocxDeserializer};
//# sourceMappingURL=index.esm.js.map
